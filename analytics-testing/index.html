<!DOCTYPE html>
<html lang="en">
<head>  
    <!-- Google Tag Manager -->
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-KBBC696T');
    </script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A simple website hosting an embedded iframe form.">
    <meta name="author" content="dayl cannon">
    <title>Dayl's Cafe Cafeteria</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }
        header {
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 20px 0;
        }
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 70vh;
            padding: 20px;
        }
        iframe {
            border: none;
            width: 80%;
            max-width: 800px;
            height: 400px;
        }
        footer {
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 10px 0;
        }
        @media (max-width: 768px) {
            iframe {
                height: 300px;
                width: 95%;
            }
        }
    </style>
    <script>
        // Listening for messages from the iframe
        window.addEventListener('message', function(event) {
            // Ensure the message comes from the expected origin
            if (event.origin !== "https://app.geckoform.com") return;

            // Check if the event data contains the expected structure
            if (event.data && event.data.event === "form_start") {
                // Push the event data into GTM's existing dataLayer
                dataLayer.push({
                    event: event.data.event,
                    eventModel: {
                        form_id: event.data.eventModel.form_id,
                        form_name: event.data.eventModel.form_name,
                        form_destination: event.data.eventModel.form_destination,
                        form_length: event.data.eventModel.form_length,
                        first_field_id: event.data.eventModel.first_field_id,
                        first_field_name: event.data.eventModel.first_field_name,
                        first_field_type: event.data.eventModel.first_field_type,
                        first_field_position: event.data.eventModel.first_field_position
                    },
                    gtm: {
                        uniqueEventId: event.data.gtm.uniqueEventId,
                        priorityId: event.data.gtm.priorityId
                    }
                });

                // Optional: Log the captured event for debugging
                console.log("Form event captured:", event.data);
            }
        });
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KBBC696T"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header>
        <h1>Dayl's Cafe Cafeteria</h1>
        <p>Below is the embedded Gecko form.</p>
    </header>

    <main>
        <iframe src="https://app.geckoform.com/public/#/iframe/21FO00y2snbkm3005vt3uy7gcz" 
            width="100%" height="300" frameborder="0" 
            seamless title="GeckoForm Form Embed">
        </iframe>
    </main>

    <footer>
        <p>&copy; 2024 Dayl's Cafe Cafeteria. All rights reserved.</p>
    </footer>
</body>
</html>
